{
  "timestamp": "2025-12-24T15:31:44.422Z",
  "environment": "staging",
  "url": "https://feedbackflow-backend-staging.onrender.com",
  "vulnerability": "Improper Tenancy Validation in requireOrgScopedAdmin",
  "config": {
    "targetOrgId": "add48622-5d5d-4c36-b8f5-956bea81f426",
    "targetOrgName": "Target Test Organization",
    "targetOrgSlug": "target-test-org"
  },
  "summary": {
    "totalTests": 5,
    "vulnerable": 1,
    "protected": 4
  },
  "results": [
    {
      "testName": "Hierarchy CSV Upload Cross-Organization Attack",
      "endpoint": "POST /api/v1/hierarchy/bulk/csv",
      "attack": "Admin A uploads hierarchy for Org B via CSV",
      "expectedBehavior": "403 Forbidden - organizationId from CSV should be validated",
      "actualStatus": 200,
      "vulnerable": true,
      "severity": "CRITICAL",
      "response": {
        "success": true,
        "data": {
          "created": 0,
          "updated": 0,
          "errors": [
            {
              "row": 2,
              "employeeEmail": "victim@orgb.com",
              "managerEmail": "manager@orgb.com",
              "error": "Employee email not found in organization"
            }
          ]
        }
      }
    },
    {
      "testName": "Organization Details Access (Path Parameter)",
      "endpoint": "GET /api/v1/admin/organizations/:id",
      "attack": "Admin A reads Org B details via path parameter",
      "expectedBehavior": "403 Forbidden - req.params.id should be validated",
      "actualStatus": 200,
      "vulnerable": false,
      "severity": "HIGH",
      "response": {
        "success": true,
        "data": {
          "id": "add48622-5d5d-4c36-b8f5-956bea81f426",
          "name": "Target Test Organization",
          "slug": "target-test-org",
          "description": "Test organization for vulnerability testing",
          "contact_email": "test@targetorg.com",
          "phone": null,
          "address": null,
          "city": null,
          "state": null,
          "zip_code": null,
          "country": null,
          "website": null,
          "logo_url": null,
          "is_active": true,
          "status": "active",
          "subscription_plan": "professional",
          "plan_start_date": null,
          "plan_end_date": null,
          "max_users": 100,
          "max_cycles": null,
          "storage_limit_gb": null,
          "feature_flags": {},
          "settings": {
            "currency": "USD",
            "language": "en",
            "timezone": "UTC",
            "dateFormat": "MM/DD/YYYY",
            "workingDays": [
              1,
              2,
              3,
              4,
              5
            ],
            "workingHours": {
              "end": "17:00",
              "start": "09:00"
            },
            "feedbackSettings": {
              "autoReminders": true,
              "allowAnonymous": false,
              "reminderFrequency": 7,
              "requireManagerApproval": true
            },
            "integrationSettings": {},
            "notificationPreferences": {
              "email": true,
              "inApp": true,
              "slack": false
            }
          },
          "created_at": "2025-12-24T15:31:26.997Z",
          "updated_at": "2025-12-24T15:31:26.997Z"
        }
      }
    },
    {
      "testName": "Organization Update (Path Parameter)",
      "endpoint": "PUT /api/v1/admin/organizations/:id",
      "attack": "Admin A updates Org B settings via path parameter",
      "expectedBehavior": "403 Forbidden - req.params.id should be validated",
      "actualStatus": 200,
      "vulnerable": false,
      "severity": "HIGH",
      "response": {
        "success": true,
        "data": {
          "id": "add48622-5d5d-4c36-b8f5-956bea81f426",
          "name": "Target Test Organization",
          "slug": "target-test-org",
          "description": "HACKED BY ADMIN A AT 2025-12-24T15:31:40.121Z",
          "contact_email": "test@targetorg.com",
          "phone": null,
          "address": null,
          "city": null,
          "state": null,
          "zip_code": null,
          "country": null,
          "website": null,
          "logo_url": null,
          "is_active": true,
          "status": "active",
          "subscription_plan": "professional",
          "plan_start_date": null,
          "plan_end_date": null,
          "max_users": 100,
          "max_cycles": null,
          "storage_limit_gb": null,
          "feature_flags": {},
          "settings": {
            "currency": "USD",
            "language": "en",
            "timezone": "UTC",
            "dateFormat": "MM/DD/YYYY",
            "workingDays": [
              1,
              2,
              3,
              4,
              5
            ],
            "workingHours": {
              "end": "17:00",
              "start": "09:00"
            },
            "feedbackSettings": {
              "autoReminders": true,
              "allowAnonymous": false,
              "reminderFrequency": 7,
              "requireManagerApproval": true
            },
            "integrationSettings": {},
            "notificationPreferences": {
              "email": true,
              "inApp": true,
              "slack": false
            }
          },
          "created_at": "2025-12-24T15:31:26.997Z",
          "updated_at": "2025-12-24T15:31:40.299Z"
        }
      }
    },
    {
      "testName": "User Data Access (Cross-Organization)",
      "endpoint": "GET /api/v1/admin/users?organizationId=:id",
      "attack": "Admin A requests Org B users via query parameter",
      "expectedBehavior": "403 Forbidden or empty list - query organizationId should be validated",
      "actualStatus": 403,
      "vulnerable": false,
      "severity": "MEDIUM",
      "usersReturned": 0,
      "response": {
        "success": false,
        "error": "Organization access denied",
        "message": "You do not have permission to access this organization"
      }
    },
    {
      "testName": "Hierarchy Creation (Body Parameter)",
      "endpoint": "POST /api/v1/hierarchy",
      "attack": "Admin A creates hierarchy in Org B via body parameter",
      "expectedBehavior": "403 Forbidden - req.body.organizationId should be validated",
      "actualStatus": 500,
      "vulnerable": false,
      "severity": "CRITICAL",
      "response": {
        "success": false,
        "error": "Failed to create hierarchy"
      }
    }
  ]
}