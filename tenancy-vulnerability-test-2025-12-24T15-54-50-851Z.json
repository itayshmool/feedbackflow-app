{
  "timestamp": "2025-12-24T15:54:50.851Z",
  "environment": "staging",
  "url": "https://feedbackflow-backend.onrender.com",
  "vulnerability": "Improper Tenancy Validation in requireOrgScopedAdmin",
  "config": {
    "targetOrgId": "add48622-5d5d-4c36-b8f5-956bea81f426",
    "targetOrgName": "Target Test Organization",
    "targetOrgSlug": "target-test-org"
  },
  "summary": {
    "totalTests": 5,
    "vulnerable": 1,
    "protected": 4
  },
  "results": [
    {
      "testName": "Hierarchy CSV Upload Cross-Organization Attack",
      "endpoint": "POST /api/v1/hierarchy/bulk/csv",
      "attack": "Admin A uploads hierarchy for Org B via CSV",
      "expectedBehavior": "403 Forbidden - organizationId from CSV should be validated",
      "actualStatus": 200,
      "vulnerable": true,
      "severity": "CRITICAL",
      "response": {
        "success": true,
        "data": {
          "created": 0,
          "updated": 0,
          "errors": [
            {
              "row": 2,
              "employeeEmail": "victim@orgb.com",
              "managerEmail": "manager@orgb.com",
              "error": "Organization not found: Target Test Organization (target-test-org)"
            }
          ]
        }
      }
    },
    {
      "testName": "Organization Details Access (Path Parameter)",
      "endpoint": "GET /api/v1/admin/organizations/:id",
      "attack": "Admin A reads Org B details via path parameter",
      "expectedBehavior": "403 Forbidden - req.params.id should be validated",
      "actualStatus": 404,
      "vulnerable": false,
      "severity": "HIGH",
      "response": {
        "success": false,
        "error": "Organization not found"
      }
    },
    {
      "testName": "Organization Update (Path Parameter)",
      "endpoint": "PUT /api/v1/admin/organizations/:id",
      "attack": "Admin A updates Org B settings via path parameter",
      "expectedBehavior": "403 Forbidden - req.params.id should be validated",
      "actualStatus": 500,
      "vulnerable": false,
      "severity": "HIGH",
      "response": {
        "success": false,
        "error": "Failed to update organization",
        "details": "Organization not found"
      }
    },
    {
      "testName": "User Data Access (Cross-Organization)",
      "endpoint": "GET /api/v1/admin/users?organizationId=:id",
      "attack": "Admin A requests Org B users via query parameter",
      "expectedBehavior": "403 Forbidden or empty list - query organizationId should be validated",
      "actualStatus": 403,
      "vulnerable": false,
      "severity": "MEDIUM",
      "usersReturned": 0,
      "response": {
        "success": false,
        "error": "Organization access denied",
        "message": "You do not have permission to access this organization"
      }
    },
    {
      "testName": "Hierarchy Creation (Body Parameter)",
      "endpoint": "POST /api/v1/hierarchy",
      "attack": "Admin A creates hierarchy in Org B via body parameter",
      "expectedBehavior": "403 Forbidden - req.body.organizationId should be validated",
      "actualStatus": 403,
      "vulnerable": false,
      "severity": "CRITICAL",
      "response": {
        "success": false,
        "error": "You do not have permission to access this organization"
      }
    }
  ]
}